<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mycode.jxzlpj.jiaoxuexiaoguo.kczlfxbg.mapper.KczlfxbgMapper">

    <select id="getPageList" resultType="com.mycode.jxzlpj.jiaoxuexiaoguo.kczlfxbg.doman.Kczlfxbg">
        SELECT t1.COURSE_CODE,t1.COURSE_NAME,t1.COURSE_ATTR,t1.XY_NAME,T1.ZY_NAME,xn,XQ, wm_concat(js.user_name) skjs, t1.sk_bj skbj
        FROM SYS_DATA_KC t1
        LEFT JOIN SYS_DATA_JSRK t2 ON T2.COURSE_CODE = T1.COURSE_CODE
        LEFT JOIN SYS_DATA_JS js on js.user_id = t2.USER_ID
        <where>
            <if test="courseName != null and courseName != ''">
                and t1.COURSE_NAME like concat(concat('%',#{courseName}),'%')
            </if>
        </where>
        GROUP BY t1.COURSE_CODE,t1.COURSE_NAME,t1.COURSE_ATTR,t1.XY_NAME,T1.ZY_NAME,xn,XQ, t1.sk_bj
    </select>

    <insert id="insert">
          insert into JXXG_KCZLFXBG
          (CODE, COURSE_CODE, COURSE_NAME, COURSE_ATTR, XUE_NIAN, XUE_QI, OPEN_COLLEGE, XI_JIAOYANSHI, TEACHERS, TEACH_CLASS, USER_ID, USER_NAME, USER_UNIT, CREATE_DATE)
          values
          (#{code},#{courseCode},#{courseName},#{courseAttr},#{xueNian},#{xueQi},#{openCollege},#{xiJiaoyanshi},#{teachers},#{teachClass},#{userId},#{userName},#{userUnit},CURRENT_DATE)
    </insert>

    <update id="update">
        update JXXG_KCZLFXBG
        <set>
            <if test="courseCode != null and courseCode != ''">
                COURSE_CODE = #{courseCode}
            </if>
            <if test="courseName != null and courseName != ''">
                , COURSE_NAME = #{courseName}
            </if>
            <if test="courseAttr != null and courseAttr != ''">
                , COURSE_ATTR = #{courseAttr}
            </if>
            <if test="xueNian != null and xueNian != ''">
                , XUE_NIAN = #{xueNian}
            </if>
            <if test="xueQi != null and xueQi != ''">
                , XUE_QI = #{xueQi}
            </if>
            <if test="openCollege != null and openCollege != ''">
                , OPEN_COLLEGE = #{openCollege}
            </if>
            <if test="xiJiaoyanshi != null and xiJiaoyanshi != ''">
                , XI_JIAOYANSHI = #{xiJiaoyanshi}
            </if>
            <if test="teachers != null and teachers != ''">
                , TEACHERS = #{teachers}
            </if>
            <if test="teachClass != null and teachClass != ''">
                , TEACH_CLASS = #{teachClass}
            </if>
        </set>
        where code = #{code}
    </update>

    <delete id="delete">
        delete from JXXG_KCZLFXBG where code = #{code}
    </delete>

</mapper>